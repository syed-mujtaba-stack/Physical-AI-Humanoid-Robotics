"use strict";(globalThis.webpackChunktextbook_frontend=globalThis.webpackChunktextbook_frontend||[]).push([[8257],{4335:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"chapter-02-ros2-fundamentals","title":"Chapter 2: ROS 2 Fundamentals - The Robotic Nervous System","description":"Learning Objectives","source":"@site/docs/chapter-02-ros2-fundamentals.md","sourceDirName":".","slug":"/chapter-02-ros2-fundamentals","permalink":"/Physical-AI-Humanoid-Robotics/docs/chapter-02-ros2-fundamentals","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/chapter-02-ros2-fundamentals.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Congratulations!","permalink":"/Physical-AI-Humanoid-Robotics/docs/tutorial-basics/congratulations"},"next":{"title":"Tutorial - Extras","permalink":"/Physical-AI-Humanoid-Robotics/docs/category/tutorial---extras"}}');var i=n(4848),t=n(8453);const l={sidebar_position:3},o="Chapter 2: ROS 2 Fundamentals - The Robotic Nervous System",a={},c=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"What is ROS 2?",id:"what-is-ros-2",level:2},{value:"Why ROS 2 (vs ROS 1)?",id:"why-ros-2-vs-ros-1",level:3},{value:"Core Concepts",id:"core-concepts",level:2},{value:"1. Nodes",id:"1-nodes",level:3},{value:"2. Topics (Publish-Subscribe)",id:"2-topics-publish-subscribe",level:3},{value:"3. Services (Request-Response)",id:"3-services-request-response",level:3},{value:"4. Actions (Long-Running Tasks)",id:"4-actions-long-running-tasks",level:3},{value:"Message Types",id:"message-types",level:2},{value:"Standard Messages (<code>std_msgs</code>)",id:"standard-messages-std_msgs",level:3},{value:"Sensor Messages (<code>sensor_msgs</code>)",id:"sensor-messages-sensor_msgs",level:3},{value:"Geometry Messages (<code>geometry_msgs</code>)",id:"geometry-messages-geometry_msgs",level:3},{value:"Quality of Service (QoS)",id:"quality-of-service-qos",level:2},{value:"Launch Files",id:"launch-files",level:2},{value:"Parameters",id:"parameters",level:2},{value:"ROS 2 Command-Line Tools",id:"ros-2-command-line-tools",level:2},{value:"Essential Commands",id:"essential-commands",level:3},{value:"Lab Exercise: Building a Robot Heartbeat System",id:"lab-exercise-building-a-robot-heartbeat-system",level:2},{value:"Objective",id:"objective",level:3},{value:"Step 1: Create a Package",id:"step-1-create-a-package",level:3},{value:"Step 2: Heartbeat Publisher",id:"step-2-heartbeat-publisher",level:3},{value:"Step 3: Monitor Subscriber",id:"step-3-monitor-subscriber",level:3},{value:"Step 4: Diagnostics Service",id:"step-4-diagnostics-service",level:3},{value:"Step 5: Update <code>setup.py</code>",id:"step-5-update-setuppy",level:3},{value:"Step 6: Build and Run",id:"step-6-build-and-run",level:3},{value:"Expected Output",id:"expected-output",level:3},{value:"Quiz",id:"quiz",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"chapter-2-ros-2-fundamentals---the-robotic-nervous-system",children:"Chapter 2: ROS 2 Fundamentals - The Robotic Nervous System"})}),"\n",(0,i.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Understand the architecture and purpose of ROS 2"}),"\n",(0,i.jsx)(r.li,{children:"Master core concepts: nodes, topics, services, and actions"}),"\n",(0,i.jsx)(r.li,{children:"Build publisher and subscriber nodes in Python"}),"\n",(0,i.jsx)(r.li,{children:"Implement service clients and servers"}),"\n",(0,i.jsx)(r.li,{children:"Understand the DDS middleware and QoS policies"}),"\n",(0,i.jsx)(r.li,{children:"Create launch files for complex robot systems"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"what-is-ros-2",children:"What is ROS 2?"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"ROS 2 (Robot Operating System 2)"})," is not an operating system in the traditional sense, but rather a ",(0,i.jsx)(r.strong,{children:"middleware framework"})," that provides:"]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Communication Infrastructure"}),": Inter-process communication (IPC) between robot components"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Hardware Abstraction"}),": Standardized interfaces for sensors and actuators"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Package Management"}),": Modular, reusable software components"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Tools"}),": Visualization (RViz), simulation (Gazebo), debugging, and logging"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"why-ros-2-vs-ros-1",children:"Why ROS 2 (vs ROS 1)?"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Feature"}),(0,i.jsx)(r.th,{children:"ROS 1"}),(0,i.jsx)(r.th,{children:"ROS 2"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Real-time"})}),(0,i.jsx)(r.td,{children:"No"}),(0,i.jsx)(r.td,{children:"Yes (with DDS)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Multi-robot"})}),(0,i.jsx)(r.td,{children:"Difficult"}),(0,i.jsx)(r.td,{children:"Native support"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Security"})}),(0,i.jsx)(r.td,{children:"None"}),(0,i.jsx)(r.td,{children:"DDS Security"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Platforms"})}),(0,i.jsx)(r.td,{children:"Linux only"}),(0,i.jsx)(r.td,{children:"Linux, Windows, macOS"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Communication"})}),(0,i.jsx)(r.td,{children:"Custom (TCPROS)"}),(0,i.jsx)(r.td,{children:"DDS (industry standard)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Production"})}),(0,i.jsx)(r.td,{children:"Research"}),(0,i.jsx)(r.td,{children:"Production-ready"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"DDS (Data Distribution Service)"})," is an industry-standard middleware used in aerospace, defense, and automotive systems. ROS 2 leverages DDS for robust, real-time communication."]}),"\n",(0,i.jsx)(r.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,i.jsx)(r.h3,{id:"1-nodes",children:"1. Nodes"}),"\n",(0,i.jsxs)(r.p,{children:["A ",(0,i.jsx)(r.strong,{children:"node"})," is a process that performs a specific computation. Examples:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Camera driver node (publishes images)"}),"\n",(0,i.jsx)(r.li,{children:"Object detection node (subscribes to images, publishes bounding boxes)"}),"\n",(0,i.jsx)(r.li,{children:"Motor controller node (subscribes to velocity commands, controls motors)"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Design Philosophy"}),": Each node should have a single, well-defined responsibility (Unix philosophy)."]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass MinimalNode(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_node')  # Node name\r\n        self.get_logger().info('Node has been started!')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MinimalNode()\r\n    rclpy.spin(node)  # Keep node alive\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"2-topics-publish-subscribe",children:"2. Topics (Publish-Subscribe)"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Topics"})," enable asynchronous, many-to-many communication. A node can:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Publish"})," messages to a topic (e.g., ",(0,i.jsx)(r.code,{children:"/camera/image"}),")"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Subscribe"})," to a topic to receive messages"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:"graph LR\r\n    A[Camera Node] --\x3e|publishes| B[/camera/image]\r\n    B --\x3e|subscribes| C[Object Detector]\r\n    B --\x3e|subscribes| D[Image Saver]\r\n    B --\x3e|subscribes| E[Display Node]\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Publisher"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass PublisherNode(Node):\r\n    def __init__(self):\r\n        super().__init__('publisher_node')\r\n        self.publisher_ = self.create_publisher(String, 'chatter', 10)\r\n        self.timer = self.create_timer(1.0, self.timer_callback)\r\n        self.counter = 0\r\n    \r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Hello ROS 2: {self.counter}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.counter += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = PublisherNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Subscriber"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass SubscriberNode(Node):\r\n    def __init__(self):\r\n        super().__init__('subscriber_node')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'chatter',\r\n            self.listener_callback,\r\n            10)\r\n    \r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = SubscriberNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"3-services-request-response",children:"3. Services (Request-Response)"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Services"})," provide synchronous, one-to-one communication. Use cases:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:'Trigger an action (e.g., "start recording")'}),"\n",(0,i.jsx)(r.li,{children:'Query information (e.g., "what is the battery level?")'}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:"sequenceDiagram\r\n    participant Client\r\n    participant Server\r\n    Client->>Server: Request (e.g., add 5 + 3)\r\n    Server->>Client: Response (8)\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Service Server"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass AddTwoIntsServer(Node):\r\n    def __init__(self):\r\n        super().__init__('add_two_ints_server')\r\n        self.srv = self.create_service(\r\n            AddTwoInts, \r\n            'add_two_ints', \r\n            self.add_two_ints_callback)\r\n        self.get_logger().info('Service server ready.')\r\n    \r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'{request.a} + {request.b} = {response.sum}')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AddTwoIntsServer()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Service Client"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nimport sys\r\n\r\nclass AddTwoIntsClient(Node):\r\n    def __init__(self):\r\n        super().__init__('add_two_ints_client')\r\n        self.client = self.create_client(AddTwoInts, 'add_two_ints')\r\n        \r\n        while not self.client.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('Service not available, waiting...')\r\n        \r\n        self.request = AddTwoInts.Request()\r\n    \r\n    def send_request(self, a, b):\r\n        self.request.a = a\r\n        self.request.b = b\r\n        self.future = self.client.call_async(self.request)\r\n        return self.future\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AddTwoIntsClient()\r\n    future = node.send_request(int(sys.argv[1]), int(sys.argv[2]))\r\n    rclpy.spin_until_future_complete(node, future)\r\n    \r\n    response = future.result()\r\n    node.get_logger().info(f'Result: {response.sum}')\r\n    \r\n    node.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"4-actions-long-running-tasks",children:"4. Actions (Long-Running Tasks)"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Actions"})," are for tasks that:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Take time to complete (e.g., navigation to a goal)"}),"\n",(0,i.jsx)(r.li,{children:"Provide feedback during execution"}),"\n",(0,i.jsx)(r.li,{children:"Can be canceled"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:"sequenceDiagram\r\n    participant Client\r\n    participant Server\r\n    Client->>Server: Goal (navigate to x, y)\r\n    Server->>Client: Feedback (50% complete)\r\n    Server->>Client: Feedback (75% complete)\r\n    Server->>Client: Result (success)\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Action Server (Fibonacci)"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.action import ActionServer\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.action import Fibonacci\r\n\r\nclass FibonacciActionServer(Node):\r\n    def __init__(self):\r\n        super().__init__('fibonacci_action_server')\r\n        self._action_server = ActionServer(\r\n            self,\r\n            Fibonacci,\r\n            'fibonacci',\r\n            self.execute_callback)\r\n    \r\n    def execute_callback(self, goal_handle):\r\n        self.get_logger().info('Executing goal...')\r\n        \r\n        feedback_msg = Fibonacci.Feedback()\r\n        feedback_msg.sequence = [0, 1]\r\n        \r\n        for i in range(1, goal_handle.request.order):\r\n            feedback_msg.sequence.append(\r\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\r\n            self.get_logger().info(f'Feedback: {feedback_msg.sequence}')\r\n            goal_handle.publish_feedback(feedback_msg)\r\n        \r\n        goal_handle.succeed()\r\n        result = Fibonacci.Result()\r\n        result.sequence = feedback_msg.sequence\r\n        return result\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = FibonacciActionServer()\r\n    rclpy.spin(node)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"message-types",children:"Message Types"}),"\n",(0,i.jsxs)(r.p,{children:["ROS 2 uses ",(0,i.jsx)(r.strong,{children:"message definitions"})," to structure data. Common types:"]}),"\n",(0,i.jsxs)(r.h3,{id:"standard-messages-std_msgs",children:["Standard Messages (",(0,i.jsx)(r.code,{children:"std_msgs"}),")"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"String"}),", ",(0,i.jsx)(r.code,{children:"Int32"}),", ",(0,i.jsx)(r.code,{children:"Float64"}),", ",(0,i.jsx)(r.code,{children:"Bool"})]}),"\n"]}),"\n",(0,i.jsxs)(r.h3,{id:"sensor-messages-sensor_msgs",children:["Sensor Messages (",(0,i.jsx)(r.code,{children:"sensor_msgs"}),")"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"Image"}),": Camera images"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"LaserScan"}),": LiDAR data"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"Imu"}),": Inertial measurement unit"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"JointState"}),": Robot joint positions/velocities"]}),"\n"]}),"\n",(0,i.jsxs)(r.h3,{id:"geometry-messages-geometry_msgs",children:["Geometry Messages (",(0,i.jsx)(r.code,{children:"geometry_msgs"}),")"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"Twist"}),": Linear and angular velocity"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"Pose"}),": Position and orientation"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"PoseStamped"}),": Pose with timestamp and frame"]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Publishing Velocity Commands"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from geometry_msgs.msg import Twist\r\n\r\nclass VelocityPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('velocity_publisher')\r\n        self.publisher_ = self.create_publisher(Twist, '/cmd_vel', 10)\r\n        self.timer = self.create_timer(0.1, self.publish_velocity)\r\n    \r\n    def publish_velocity(self):\r\n        msg = Twist()\r\n        msg.linear.x = 0.5  # Move forward at 0.5 m/s\r\n        msg.angular.z = 0.1  # Turn at 0.1 rad/s\r\n        self.publisher_.publish(msg)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"quality-of-service-qos",children:"Quality of Service (QoS)"}),"\n",(0,i.jsx)(r.p,{children:"QoS policies control how messages are delivered. Key parameters:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Policy"}),(0,i.jsx)(r.th,{children:"Options"}),(0,i.jsx)(r.th,{children:"Use Case"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Reliability"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"RELIABLE"}),", ",(0,i.jsx)(r.code,{children:"BEST_EFFORT"})]}),(0,i.jsx)(r.td,{children:"Sensor data (best effort) vs commands (reliable)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Durability"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"VOLATILE"}),", ",(0,i.jsx)(r.code,{children:"TRANSIENT_LOCAL"})]}),(0,i.jsx)(r.td,{children:"Retain messages for late joiners"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"History"})}),(0,i.jsxs)(r.td,{children:[(0,i.jsx)(r.code,{children:"KEEP_LAST(n)"}),", ",(0,i.jsx)(r.code,{children:"KEEP_ALL"})]}),(0,i.jsx)(r.td,{children:"Buffer size"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Deadline"})}),(0,i.jsx)(r.td,{children:"Duration"}),(0,i.jsx)(r.td,{children:"Detect if messages arrive too slowly"})]})]})]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Example: Custom QoS"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\r\n\r\nqos_profile = QoSProfile(\r\n    reliability=ReliabilityPolicy.BEST_EFFORT,\r\n    history=HistoryPolicy.KEEP_LAST,\r\n    depth=10\r\n)\r\n\r\nself.subscription = self.create_subscription(\r\n    LaserScan,\r\n    '/scan',\r\n    self.scan_callback,\r\n    qos_profile)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"launch-files",children:"Launch Files"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Launch files"})," start multiple nodes with a single command. Written in Python (ROS 2) or XML."]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsxs)(r.strong,{children:["Example: Launch File (",(0,i.jsx)(r.code,{children:"robot_launch.py"}),")"]})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from launch import LaunchDescription\r\nfrom launch_ros.actions import Node\r\n\r\ndef generate_launch_description():\r\n    return LaunchDescription([\r\n        Node(\r\n            package='my_robot_pkg',\r\n            executable='camera_node',\r\n            name='camera',\r\n            output='screen',\r\n            parameters=[{'frame_rate': 30}]\r\n        ),\r\n        Node(\r\n            package='my_robot_pkg',\r\n            executable='object_detector',\r\n            name='detector',\r\n            output='screen'\r\n        ),\r\n        Node(\r\n            package='my_robot_pkg',\r\n            executable='motor_controller',\r\n            name='controller',\r\n            output='screen'\r\n        ),\r\n    ])\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Run the launch file:"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"ros2 launch my_robot_pkg robot_launch.py\n"})}),"\n",(0,i.jsx)(r.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Parameters"})," allow runtime configuration without recompiling code."]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Declaring and Using Parameters:"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"class ParameterNode(Node):\r\n    def __init__(self):\r\n        super().__init__('parameter_node')\r\n        \r\n        # Declare parameter with default value\r\n        self.declare_parameter('max_speed', 1.0)\r\n        \r\n        # Get parameter value\r\n        self.max_speed = self.get_parameter('max_speed').value\r\n        self.get_logger().info(f'Max speed: {self.max_speed}')\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Set parameter from command line:"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"ros2 run my_pkg parameter_node --ros-args -p max_speed:=2.5\n"})}),"\n",(0,i.jsx)(r.h2,{id:"ros-2-command-line-tools",children:"ROS 2 Command-Line Tools"}),"\n",(0,i.jsx)(r.h3,{id:"essential-commands",children:"Essential Commands"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'# List active nodes\r\nros2 node list\r\n\r\n# Get info about a node\r\nros2 node info /camera_node\r\n\r\n# List topics\r\nros2 topic list\r\n\r\n# Echo messages from a topic\r\nros2 topic echo /camera/image\r\n\r\n# Get topic info (publishers, subscribers, message type)\r\nros2 topic info /cmd_vel\r\n\r\n# Publish a message manually\r\nros2 topic pub /cmd_vel geometry_msgs/msg/Twist "{linear: {x: 0.5}, angular: {z: 0.1}}"\r\n\r\n# List services\r\nros2 service list\r\n\r\n# Call a service\r\nros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 5, b: 3}"\r\n\r\n# Record data to a bag file\r\nros2 bag record -a  # Record all topics\r\n\r\n# Play back recorded data\r\nros2 bag play my_bag_file\n'})}),"\n",(0,i.jsx)(r.h2,{id:"lab-exercise-building-a-robot-heartbeat-system",children:"Lab Exercise: Building a Robot Heartbeat System"}),"\n",(0,i.jsx)(r.h3,{id:"objective",children:"Objective"}),"\n",(0,i.jsx)(r.p,{children:"Create a multi-node system where:"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["A ",(0,i.jsx)(r.strong,{children:"heartbeat node"})," publishes the robot's status every second"]}),"\n",(0,i.jsxs)(r.li,{children:["A ",(0,i.jsx)(r.strong,{children:"monitor node"})," subscribes and logs the status"]}),"\n",(0,i.jsxs)(r.li,{children:["A ",(0,i.jsx)(r.strong,{children:"diagnostics service"})," provides detailed system info on request"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"step-1-create-a-package",children:"Step 1: Create a Package"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"cd ~/ros2_ws/src\r\nros2 pkg create --build-type ament_python robot_heartbeat --dependencies rclpy std_msgs example_interfaces\r\ncd robot_heartbeat\n"})}),"\n",(0,i.jsx)(r.h3,{id:"step-2-heartbeat-publisher",children:"Step 2: Heartbeat Publisher"}),"\n",(0,i.jsxs)(r.p,{children:["Create ",(0,i.jsx)(r.code,{children:"robot_heartbeat/heartbeat_publisher.py"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\nimport psutil  # For system metrics\r\n\r\nclass HeartbeatPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('heartbeat_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'robot/heartbeat', 10)\r\n        self.timer = self.create_timer(1.0, self.publish_heartbeat)\r\n        self.counter = 0\r\n        self.get_logger().info('Heartbeat Publisher Started')\r\n    \r\n    def publish_heartbeat(self):\r\n        msg = String()\r\n        cpu_percent = psutil.cpu_percent()\r\n        msg.data = f'Heartbeat #{self.counter} | CPU: {cpu_percent}%'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Published: {msg.data}')\r\n        self.counter += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = HeartbeatPublisher()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"step-3-monitor-subscriber",children:"Step 3: Monitor Subscriber"}),"\n",(0,i.jsxs)(r.p,{children:["Create ",(0,i.jsx)(r.code,{children:"robot_heartbeat/heartbeat_monitor.py"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass HeartbeatMonitor(Node):\r\n    def __init__(self):\r\n        super().__init__('heartbeat_monitor')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'robot/heartbeat',\r\n            self.heartbeat_callback,\r\n            10)\r\n        self.get_logger().info('Heartbeat Monitor Started')\r\n    \r\n    def heartbeat_callback(self, msg):\r\n        self.get_logger().info(f'Received: {msg.data}', throttle_duration_sec=5.0)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = HeartbeatMonitor()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h3,{id:"step-4-diagnostics-service",children:"Step 4: Diagnostics Service"}),"\n",(0,i.jsxs)(r.p,{children:["Create ",(0,i.jsx)(r.code,{children:"robot_heartbeat/diagnostics_service.py"}),":"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import Trigger\r\nimport psutil\r\n\r\nclass DiagnosticsService(Node):\r\n    def __init__(self):\r\n        super().__init__('diagnostics_service')\r\n        self.srv = self.create_service(\r\n            Trigger,\r\n            'robot/diagnostics',\r\n            self.diagnostics_callback)\r\n        self.get_logger().info('Diagnostics Service Ready')\r\n    \r\n    def diagnostics_callback(self, request, response):\r\n        cpu = psutil.cpu_percent()\r\n        memory = psutil.virtual_memory().percent\r\n        disk = psutil.disk_usage('/').percent\r\n        \r\n        response.success = True\r\n        response.message = f'CPU: {cpu}% | Memory: {memory}% | Disk: {disk}%'\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = DiagnosticsService()\r\n    rclpy.spin(node)\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsxs)(r.h3,{id:"step-5-update-setuppy",children:["Step 5: Update ",(0,i.jsx)(r.code,{children:"setup.py"})]}),"\n",(0,i.jsxs)(r.p,{children:["Edit ",(0,i.jsx)(r.code,{children:"setup.py"})," to register the executables:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"entry_points={\r\n    'console_scripts': [\r\n        'heartbeat_publisher = robot_heartbeat.heartbeat_publisher:main',\r\n        'heartbeat_monitor = robot_heartbeat.heartbeat_monitor:main',\r\n        'diagnostics_service = robot_heartbeat.diagnostics_service:main',\r\n    ],\r\n},\n"})}),"\n",(0,i.jsx)(r.h3,{id:"step-6-build-and-run",children:"Step 6: Build and Run"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"cd ~/ros2_ws\r\ncolcon build --packages-select robot_heartbeat\r\nsource install/setup.bash\r\n\r\n# Terminal 1: Heartbeat Publisher\r\nros2 run robot_heartbeat heartbeat_publisher\r\n\r\n# Terminal 2: Heartbeat Monitor\r\nros2 run robot_heartbeat heartbeat_monitor\r\n\r\n# Terminal 3: Call Diagnostics Service\r\nros2 service call /robot/diagnostics example_interfaces/srv/Trigger\n"})}),"\n",(0,i.jsx)(r.h3,{id:"expected-output",children:"Expected Output"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Terminal 1 (Publisher):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"[INFO] [heartbeat_publisher]: Published: Heartbeat #0 | CPU: 12.5%\r\n[INFO] [heartbeat_publisher]: Published: Heartbeat #1 | CPU: 15.2%\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Terminal 2 (Monitor):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"[INFO] [heartbeat_monitor]: Received: Heartbeat #0 | CPU: 12.5%\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Terminal 3 (Service Call):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"success: True\r\nmessage: 'CPU: 14.3% | Memory: 45.2% | Disk: 62.1%'\n"})}),"\n",(0,i.jsx)(r.h2,{id:"quiz",children:"Quiz"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"What is the primary communication pattern for topics in ROS 2?"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"A) Request-Response"}),"\n",(0,i.jsx)(r.li,{children:"B) Publish-Subscribe"}),"\n",(0,i.jsx)(r.li,{children:"C) Peer-to-Peer"}),"\n",(0,i.jsx)(r.li,{children:"D) Client-Server"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Answer: B"})," - Topics use asynchronous publish-subscribe."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"When should you use a service instead of a topic?"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"A) For continuous sensor data"}),"\n",(0,i.jsx)(r.li,{children:"B) For one-time requests that need a response"}),"\n",(0,i.jsx)(r.li,{children:"C) For broadcasting to multiple nodes"}),"\n",(0,i.jsx)(r.li,{children:"D) For real-time control loops"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Answer: B"})," - Services are synchronous request-response."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"What does QoS stand for, and why is it important?"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"A) Quality of Service; controls message delivery guarantees"}),"\n",(0,i.jsx)(r.li,{children:"B) Query of State; checks node status"}),"\n",(0,i.jsx)(r.li,{children:"C) Queue of Subscribers; manages topic listeners"}),"\n",(0,i.jsx)(r.li,{children:"D) Quick Operating System; speeds up ROS"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Answer: A"})," - QoS policies define reliability, durability, and history."]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Which message type would you use to send velocity commands to a robot?"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["A) ",(0,i.jsx)(r.code,{children:"std_msgs/String"})]}),"\n",(0,i.jsxs)(r.li,{children:["B) ",(0,i.jsx)(r.code,{children:"sensor_msgs/Imu"})]}),"\n",(0,i.jsxs)(r.li,{children:["C) ",(0,i.jsx)(r.code,{children:"geometry_msgs/Twist"})]}),"\n",(0,i.jsxs)(r.li,{children:["D) ",(0,i.jsx)(r.code,{children:"nav_msgs/Odometry"})]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Answer: C"})," - ",(0,i.jsx)(r.code,{children:"Twist"})," contains linear and angular velocity."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(r.p,{children:"In this chapter, we explored ROS 2 as the middleware backbone for robotics. We learned about nodes (independent processes), topics (pub-sub communication), services (request-response), and actions (long-running tasks). We also covered message types, QoS policies, launch files, and essential command-line tools. The lab exercise demonstrated building a multi-node system with publishers, subscribers, and services."}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Next Chapter"}),": We'll dive into URDF and Xacro, learning how to describe complex humanoid robot structures in a modular, maintainable way."]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>o});var s=n(6540);const i={},t=s.createContext(i);function l(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:r},e.children)}}}]);